# X AI Reply - X 智能回复助手

一个 Tampermonkey 用户脚本，使用 AI 为 X (Twitter) 推文生成智能回复。

## ✨ 功能特性

### 🤖 AI 回复生成
- 支持多种 AI 模型：Claude、GPT、Gemini 系列
- 自定义 API 地址支持（兼容第三方代理）
- 一键生成多条候选回复
- **流式传输**：边生成边显示（可选）
- 实时执行日志显示生成进度

### 📡 渠道管理
- **多渠道配置**：保存多个 API 配置
- **一键切换**：快速在不同渠道间切换
- **自定义模型列表**：每个渠道可配置专属模型列表
- **请求格式选择**：支持 OpenAI / Anthropic / Gemini 三种协议
- **快速切换面板**：在回复面板内直接切换渠道和模型

### 🏷️ 领域智能分类
- **9 大领域分类**：AI/科技、情感、政治、科技产品、财经、娱乐、体育、美食、通用
- **智能检测**：先用关键词快速匹配，未匹配时调用 AI 分类
- **手动切换**：下拉选择器可手动选择领域（覆盖自动检测）
- **自动风格应用**：根据领域自动选择默认风格、策略和长度
- **领域风格自定义**：可在设置中修改每个领域的默认设置
- **分领域历史**：每个领域独立存储 50 条回复历史
- **AI 风格总结**：每 5 条新历史自动总结用户风格特点

| 领域 | 默认风格 | 默认策略 |
|------|---------|----------|
| 🤖 AI/科技 | 专业严谨 | 新观点 |
| 💖 情感 | 暖心治愈 | 同意 |
| 🏛️ 政治 | 犹利毒舌 | 平衡 |
| 🎬 娱乐 | 幽默搞笑 | 吸引关注 |
| ⚽ 体育 | 吸引关注 | 同意 |
| 🍜 美食 | 暖心治愈 | 吸引关注 |

### 🖼️ 图片理解
- 自动提取推文中的图片
- 支持视觉模型（GPT-4o、Claude 3、Gemini）
- 根据图片内容生成相关回复
- 模型不支持时自动回退到纯文本

### ⚙️ 灵活配置
- **回复数量**：1/2/3/5 条
- **回复长度**：短/中/长
- **回复风格**：吸引关注、幽默搞笑、专业严谨、犀利毒舌、暖心治愈
- **回复策略**：默认、同意热评、提出新观点、平衡讨论、反驳观点
- **语言选择**：自动检测、中文、英文、日文、韩文
- 支持自定义添加/删除风格和策略
- 自动记住上次设置

## ⚠️ 已知问题

> **注意：只有部分模型请求格式经过验证**
> 
> - ✅ **Anthropic 格式** (`/v1/messages`)：正常工作
> - ✅ **Gemini 格式** (`/v1beta/models/...`)：本地反代正常
> - ⚠️ **OpenAI 格式** (`/v1/chat/completions`)：取决于代理支持
> 
> 如果遇到 API 错误，请检查：
> 1. 渠道的「请求格式」是否匹配代理支持的协议
> 2. 浏览器 F12 控制台中 `[X-AI-Reply]` 开头的日志

### 📊 评论区分析
- 自动抓取推文评论区热门回复
- AI 分析评论区主要观点和情绪
- 实时日志显示分析过程
- 根据分析结果生成更符合讨论氛围的回复

### 🌐 智能翻译
- 非中文回复自动附带中文翻译
- 翻译与回复同步生成，无需额外 API 调用
- 中文仅供阅读，实际发送原文

### 📜 历史记录
- 三标签布局：设置 | 结果 | 历史
- 自动保存每条推文的生成记录（含翻译）
- 重新打开面板可查看历史回复
- 最多保留 50 条推文记录

### 💫 UI 体验
- 渐变按钮设计
- 动画加载效果
- 实时执行日志面板
- **失败重试**：生成失败时显示重试按钮

## 📦 安装

1. 安装 [Tampermonkey](https://www.tampermonkey.net/) 浏览器扩展
2. 点击安装脚本或手动添加 `x_ai_reply.user.js`
3. 在 X.com 刷新页面

## ⚙️ 配置

1. 点击 Tampermonkey 菜单中的「⚙️ AI Reply Settings」
2. **渠道管理**：
   - 填写渠道名称（如"Claude 官方"）
   - 填入 API 地址和密钥
   - 选择模型
   - 点击「+ 新建」保存渠道
3. **领域风格配置**：
   - 选择领域（如「AI/科技」）
   - 设置该领域的默认风格、策略、长度
   - 点击「保存领域设置」
4. 保存设置

## 🎯 使用方法

1. 浏览 X.com 推文
2. 点击推文下方的「🤖 AI」按钮
3. 查看 **领域标签**（如"🤖 AI/科技"）和自动选中的风格
4. 在设置面板中：
   - 调整回复数量、长度、风格（或保持自动选中）
   - （可选）开启「流式」实时显示
   - （可选）点击「📊 分析评论区热评」
   - （可选）点击领域标签强制 AI 重新分类
5. 点击「✨ 生成回复」
6. 查看执行日志了解进度（包括领域信息）
7. 在结果中选择满意的回复，自动填入回复框

## 📄 License

MIT License
